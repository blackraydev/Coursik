{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Applications/MyFiles/Web/ProjectPlanning/PPA_UI/src/components/User/TaskModal.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { createTaskRequest, updateTaskRequest } from \"../../services/taskServices\";\nimport { DateIcon, RemoveIcon } from \"../Common/Icons\";\nimport DatePicker from \"./DatePicker\";\nimport { briefMonths, NODUEDATE, TODAY, TOMORROW, YESTERDAY } from \"../../constants/dateConstants\";\nimport { CREATE, UPDATE } from \"../../constants/modalConstants\";\nimport { getProjectsRequest } from \"../../services/projectServices\";\nimport { getRequest } from \"../../services/authServices\";\nimport { TO_DO } from \"../../constants/taskConstants\";\nimport \"../../styles/TaskModal.css\";\n\nconst TaskModal = ({\n  task,\n  closeModal,\n  type,\n  category,\n  currentProject,\n  priority\n}) => {\n  _s();\n\n  const projects = useSelector(store => store.projects);\n  const tasks = useSelector(store => store.tasks);\n  const [taskName, setTaskName] = useState(task && task.name || \"\");\n  const [description, setDescription] = useState(task && task.description || \"\");\n  const [projectId, setProjectId] = useState(currentProject && currentProject.id || task && task.project_Id || null);\n  const [showDatePicker, setShowDatePicker] = useState(false);\n  const [dueDate, setDueDate] = useState(task && task.due_Date && new Date(task.due_Date) || null);\n  const [isDueDate, setIsDueDate] = useState(!!(task && task.due_Date));\n  const [labelDueDate, setLabelDueDate] = useState(NODUEDATE);\n  const [user, setUser] = useState(null);\n  const taskNameInput = useRef();\n  const dispatch = useDispatch();\n  useEffect(() => type === CREATE ? taskNameInput.current.focus() : null, []);\n  useEffect(async () => await getProjectsRequest(getUserId(), dispatch), []);\n  useEffect(async () => await getRequest(getUserId()).then(usr => setUser(usr)));\n  useEffect(() => {\n    if (!isDueDate) {\n      return setLabelDueDate(NODUEDATE);\n    }\n\n    const currentDate = new Date();\n    const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n    const taskDay = dueDate.getDate();\n    const taskMonth = dueDate.getMonth();\n\n    switch (diff) {\n      case -1:\n        return setLabelDueDate(YESTERDAY);\n\n      case 0:\n        return setLabelDueDate(TODAY);\n\n      case 1:\n        return setLabelDueDate(TOMORROW);\n\n      default:\n        return setLabelDueDate(taskDay + \" \" + briefMonths[taskMonth]);\n    }\n  }, [dueDate]);\n\n  const setDueDateLabelColor = () => {\n    const className = \"date_picker_holder \";\n\n    if (isDueDate) {\n      const currentDate = new Date();\n      const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n\n      if (diff < 0) {\n        return className + \"past_due_date\";\n      } else if (diff === 0 || diff === 1) {\n        return className + \"current_due_date\";\n      }\n\n      return className + \"future_due_date\";\n    }\n\n    return className;\n  };\n\n  const submitTaskHandler = () => {\n    if (type === CREATE) createTask();\n    if (type === UPDATE) updateTask();\n    closeModal();\n  };\n\n  const updateTask = async () => {\n    const updatedTask = {\n      id: task.id,\n      user_Id: getUserId(),\n      project_Id: projectId,\n      category: task.category || category || TO_DO,\n      priority: task.priority,\n      name: taskName.trim(),\n      description: description,\n      due_Date: dueDate\n    };\n    return await updateTaskRequest(updatedTask, dispatch).then(data => console.log(data)).catch(e => console.log(e));\n  };\n\n  const createTask = async () => {\n    const newPriority = tasks.filter(task => task.user_Id == getUserId() && task.project_Id == projectId && task.category == TO_DO).length;\n    console.log(tasks);\n    const newTask = {\n      user_Id: getUserId(),\n      project_Id: projectId != 0 ? projectId : null,\n      category: category || TO_DO,\n      priority: priority || newPriority || 0,\n      name: taskName.trim(),\n      description: description,\n      assign_Date: new Date(),\n      due_Date: dueDate\n    };\n    return await createTaskRequest(newTask, dispatch).then(data => console.log(data)).catch(e => console.log(e));\n  };\n\n  const getUserId = () => sessionStorage.getItem(\"id\");\n\n  const removeDueDateHandler = () => {\n    setDueDate(null);\n    setIsDueDate(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"task_modal\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal_window\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: taskName,\n        onChange: e => setTaskName(e.target.value),\n        className: \"task_name\",\n        placeholder: \"Task Name\",\n        ref: taskNameInput\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"who_where\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"For\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"assign\",\n          children: /*#__PURE__*/_jsxDEV(\"option\", {\n            children: user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          onChange: e => setProjectId(e.target.value),\n          className: \"choose_project\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: 0,\n            children: \"No Project\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 25\n          }, this), projects.map(project => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: project.id,\n            selected: currentProject ? project.name === currentProject.name : task ? task.project_Id === project.id : false,\n            children: project.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 33\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"date_picker_part\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"due_date\",\n          children: \"Due date\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          tabIndex: -1,\n          onFocus: () => setShowDatePicker(true),\n          className: setDueDateLabelColor(),\n          children: [/*#__PURE__*/_jsxDEV(DateIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"date\",\n            children: labelDueDate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this), isDueDate ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"remove_icon_holder\",\n          onClick: () => removeDueDateHandler(),\n          children: /*#__PURE__*/_jsxDEV(RemoveIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 29\n        }, this) : null, showDatePicker ? /*#__PURE__*/_jsxDEV(DatePicker, {\n          selectedDate: dueDate,\n          setDueDate: setDueDate,\n          setIsDueDate: setIsDueDate,\n          setShowDatePicker: setShowDatePicker\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 29\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: description,\n        onChange: e => setDescription(e.target.value),\n        className: \"description_box\",\n        placeholder: \"Description\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"submit_part\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => submitTaskHandler(),\n          disabled: !taskName || !taskName.trim(),\n          className: \"submit_task\",\n          children: [type, \" Task\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: closeModal,\n      className: \"overlay\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 9\n  }, this);\n};\n\n_s(TaskModal, \"eiznVeDjXnImUzi5IQeoc5R9/6o=\", false, function () {\n  return [useSelector, useSelector, useDispatch];\n});\n\n_c = TaskModal;\nexport default TaskModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"TaskModal\");","map":{"version":3,"sources":["/Applications/MyFiles/Web/ProjectPlanning/PPA_UI/src/components/User/TaskModal.jsx"],"names":["React","useEffect","useRef","useState","useDispatch","useSelector","createTaskRequest","updateTaskRequest","DateIcon","RemoveIcon","DatePicker","briefMonths","NODUEDATE","TODAY","TOMORROW","YESTERDAY","CREATE","UPDATE","getProjectsRequest","getRequest","TO_DO","TaskModal","task","closeModal","type","category","currentProject","priority","projects","store","tasks","taskName","setTaskName","name","description","setDescription","projectId","setProjectId","id","project_Id","showDatePicker","setShowDatePicker","dueDate","setDueDate","due_Date","Date","isDueDate","setIsDueDate","labelDueDate","setLabelDueDate","user","setUser","taskNameInput","dispatch","current","focus","getUserId","then","usr","currentDate","diff","Math","ceil","taskDay","getDate","taskMonth","getMonth","setDueDateLabelColor","className","submitTaskHandler","createTask","updateTask","updatedTask","user_Id","trim","data","console","log","catch","e","newPriority","filter","length","newTask","assign_Date","sessionStorage","getItem","removeDueDateHandler","target","value","map","project"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { createTaskRequest, updateTaskRequest } from \"../../services/taskServices\";\nimport { DateIcon, RemoveIcon } from \"../Common/Icons\";\nimport DatePicker from \"./DatePicker\";\nimport { briefMonths, NODUEDATE, TODAY, TOMORROW, YESTERDAY } from \"../../constants/dateConstants\";\nimport { CREATE, UPDATE } from \"../../constants/modalConstants\";\nimport { getProjectsRequest } from \"../../services/projectServices\";\nimport { getRequest } from \"../../services/authServices\";\nimport { TO_DO } from \"../../constants/taskConstants\";\nimport \"../../styles/TaskModal.css\";\n\nconst TaskModal = ({ task, closeModal, type, category, currentProject, priority }) => {\n    const projects = useSelector(store => store.projects);\n    const tasks = useSelector(store => store.tasks);\n    const [taskName, setTaskName] = useState(task && task.name || \"\");\n    const [description, setDescription] = useState(task && task.description || \"\");\n    const [projectId, setProjectId] = useState(currentProject && currentProject.id || task && task.project_Id|| null);\n    const [showDatePicker, setShowDatePicker] = useState(false);\n    const [dueDate, setDueDate] = useState(task && task.due_Date && new Date(task.due_Date) || null);\n    const [isDueDate, setIsDueDate] = useState(!!(task && task.due_Date));\n    const [labelDueDate, setLabelDueDate] = useState(NODUEDATE);\n    const [user, setUser] = useState(null);\n    const taskNameInput = useRef();\n    const dispatch = useDispatch();\n\n    useEffect(() => type === CREATE ? taskNameInput.current.focus() : null, []);\n    \n    useEffect(async () => await getProjectsRequest(getUserId(), dispatch), []);\n\n    useEffect(async () => await getRequest(getUserId()).then(usr => setUser(usr)));\n\n    useEffect(() => {\n        if (!isDueDate) {\n            return setLabelDueDate(NODUEDATE);\n        }\n\n        const currentDate = new Date();\n        const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n\n        const taskDay = dueDate.getDate();\n        const taskMonth = dueDate.getMonth();\n\n        switch (diff) {\n            case -1: return setLabelDueDate(YESTERDAY);\n            case 0: return setLabelDueDate(TODAY);\n            case 1: return setLabelDueDate(TOMORROW);\n            default: return setLabelDueDate(taskDay + \" \" + briefMonths[taskMonth]);\n        }\n    }, [dueDate]);\n\n    const setDueDateLabelColor = () => {\n        const className = \"date_picker_holder \";\n\n        if (isDueDate) {\n            const currentDate = new Date();\n            const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n            \n            if (diff < 0) {\n                return className + \"past_due_date\";\n            }\n            else if (diff === 0 || diff === 1) {\n                return className + \"current_due_date\";\n            }\n            \n            return className + \"future_due_date\";\n        }\n\n        return className;\n    }\n\n    const submitTaskHandler = () => {\n        if (type === CREATE) createTask();\n        if (type === UPDATE) updateTask();\n\n        closeModal();\n    }\n\n    const updateTask = async () => {\n        const updatedTask = {\n            id: task.id,\n            user_Id: getUserId(),\n            project_Id: projectId,\n            category: task.category || category || TO_DO,\n            priority: task.priority,\n            name: taskName.trim(),\n            description: description,\n            due_Date: dueDate\n        }\n\n        return await updateTaskRequest(updatedTask, dispatch)\n            .then(data => console.log(data))\n            .catch(e => console.log(e));\n    }\n\n    const createTask = async () => {\n        const newPriority = tasks.filter(task => task.user_Id == getUserId() && \n                                                 task.project_Id == projectId && \n                                                 task.category == TO_DO).length;\n        console.log(tasks);\n        const newTask = {\n            user_Id: getUserId(),\n            project_Id: projectId != 0 ? projectId : null,\n            category: category || TO_DO,\n            priority: priority || newPriority || 0,\n            name: taskName.trim(),\n            description: description,\n            assign_Date: new Date(),\n            due_Date: dueDate\n        }\n\n        return await createTaskRequest(newTask, dispatch)\n            .then(data => console.log(data))\n            .catch(e => console.log(e));\n    }\n\n    const getUserId = () => sessionStorage.getItem(\"id\");\n\n    const removeDueDateHandler = () => {\n        setDueDate(null);\n        setIsDueDate(false);\n    }\n\n    return(\n        <div className=\"task_modal\">\n            <div className=\"modal_window\">\n                <input value={taskName} \n                       onChange={e => setTaskName(e.target.value)} \n                       className=\"task_name\" \n                       placeholder=\"Task Name\"\n                       ref={taskNameInput}\n                />\n                <div className=\"who_where\">\n                    <span>For</span>\n                    <select className=\"assign\">\n                        <option>{user.name}</option>\n                    </select>\n                    <span>in</span>\n                    <select onChange={e => setProjectId(e.target.value)} className=\"choose_project\">\n                        <option value={ 0 }>No Project</option>\n                        { \n                            projects.map(project => \n                                <option value={ project.id } \n                                        selected={ currentProject ? project.name === currentProject.name \n                                                   : task ? task.project_Id === project.id : false }\n                                >{ project.name }</option>) \n                        }\n                    </select>\n                </div>\n                <div className=\"date_picker_part\">\n                    <span className=\"due_date\">Due date</span>\n                    <div tabIndex={-1} onFocus={() => setShowDatePicker(true)} className={setDueDateLabelColor()}> \n                        <DateIcon/>\n                        <span className=\"date\">{ labelDueDate }</span>\n                    </div>\n                    { \n                        isDueDate ? \n                            <div className=\"remove_icon_holder\" onClick={() => removeDueDateHandler()}> \n                                <RemoveIcon/> \n                            </div> : null \n                    }\n                    { \n                        showDatePicker ? \n                            <DatePicker selectedDate={dueDate} \n                                        setDueDate={setDueDate} \n                                        setIsDueDate={setIsDueDate} \n                                        setShowDatePicker={setShowDatePicker} \n                            /> : null \n                    }\n                </div>\n                <textarea value={description} \n                          onChange={e => setDescription(e.target.value)} \n                          className=\"description_box\" \n                          placeholder=\"Description\"\n                />\n                <div className=\"submit_part\">\n                    <button onClick={() => submitTaskHandler()} disabled={!taskName || !taskName.trim()} className=\"submit_task\">\n                        { type } Task \n                    </button>\n                </div>\n            </div>\n            <div onClick={closeModal} className=\"overlay\"></div>\n        </div>\n    )\n}\n\nexport default TaskModal;"]},"metadata":{},"sourceType":"module"}