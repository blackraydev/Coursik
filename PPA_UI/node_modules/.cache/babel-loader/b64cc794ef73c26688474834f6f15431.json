{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Applications/MyFiles/Web/ProjectPlanning/PPA_UI/src/components/User/TaskModal.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { createTaskRequest, updateTaskRequest } from \"../../services/taskServices\";\nimport { DateIcon, RemoveIcon } from \"../Common/Icons\";\nimport DatePicker from \"./DatePicker\";\nimport { briefMonths, NODUEDATE, TODAY, TOMORROW, YESTERDAY } from \"../../constants/dateConstants\";\nimport { CREATE, UPDATE } from \"../../constants/modalConstants\";\nimport { getProjectsRequest } from \"../../services/projectServices\";\nimport \"../../styles/TaskModal.css\";\nimport { TO_DO } from \"../../constants/taskConstants\";\n\nconst TaskModal = ({\n  task,\n  closeModal,\n  type,\n  category,\n  currentProject\n}) => {\n  _s();\n\n  const projects = useSelector(store => store.projects);\n  const project = projects.find(proj => proj.id === Number(task.project_Id));\n  const [taskName, setTaskName] = useState(task && task.name || \"\");\n  const [description, setDescription] = useState(task && task.description || \"\");\n  const [projectId, setProjectId] = useState(currentProject && currentProject.id || project && project.id || null);\n  const [showDatePicker, setShowDatePicker] = useState(false);\n  const [dueDate, setDueDate] = useState(task && task.due_Date && new Date(task.due_Date) || null);\n  const [isDueDate, setIsDueDate] = useState(!!(task && task.due_Date));\n  const [labelDueDate, setLabelDueDate] = useState(NODUEDATE);\n  const taskNameInput = useRef();\n  const dispatch = useDispatch();\n  useEffect(() => type === CREATE ? taskNameInput.current.focus() : null, []);\n  useEffect(async () => await getProjectsRequest(getUserId(), dispatch), []);\n  useEffect(() => {\n    if (!isDueDate) {\n      return setLabelDueDate(NODUEDATE);\n    }\n\n    const currentDate = new Date();\n    const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n    const taskDay = dueDate.getDate();\n    const taskMonth = dueDate.getMonth();\n\n    switch (diff) {\n      case -1:\n        return setLabelDueDate(YESTERDAY);\n\n      case 0:\n        return setLabelDueDate(TODAY);\n\n      case 1:\n        return setLabelDueDate(TOMORROW);\n\n      default:\n        return setLabelDueDate(taskDay + \" \" + briefMonths[taskMonth]);\n    }\n  }, [dueDate]);\n\n  const setDueDateLabelColor = () => {\n    const className = \"date_picker_holder \";\n\n    if (isDueDate) {\n      const currentDate = new Date();\n      const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n\n      if (diff < 0) {\n        return className + \"past_due_date\";\n      } else if (diff === 0 || diff === 1) {\n        return className + \"current_due_date\";\n      }\n\n      return className + \"future_due_date\";\n    }\n\n    return className;\n  };\n\n  const submitTaskHandler = () => {\n    if (type === CREATE) createTask();\n    if (type === UPDATE) updateTask();\n    closeModal();\n  };\n\n  const updateTask = async () => {\n    const updatedTask = {\n      id: task.id,\n      user_Id: getUserId(),\n      project_Id: projectId,\n      category: category || TO_DO,\n      name: taskName.trim(),\n      description: description,\n      due_Date: dueDate\n    };\n    return await updateTaskRequest(updatedTask, dispatch).then(data => data).catch(e => console.log(e));\n  };\n\n  const createTask = async () => {\n    const newTask = {\n      user_Id: getUserId(),\n      project_Id: projectId != 0 ? projectId : null,\n      category: category || TO_DO,\n      name: taskName.trim(),\n      description: description,\n      assign_Date: new Date(),\n      due_Date: dueDate\n    };\n    console.log(newTask);\n    return await createTaskRequest(newTask, dispatch).then(data => data).catch(e => console.log(e));\n  };\n\n  const getUserId = () => sessionStorage.getItem(\"id\");\n\n  const removeDueDateHandler = () => {\n    setDueDate(null);\n    setIsDueDate(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"task_modal\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal_window\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: taskName,\n        onChange: e => setTaskName(e.target.value),\n        className: \"task_name\",\n        placeholder: \"Task Name\",\n        ref: taskNameInput\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"who_where\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"For\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"assign\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"black2001ray@mail.ru\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"sagidullin-7900@mail.ru\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          onChange: e => setProjectId(e.target.value),\n          className: \"choose_project\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: 0,\n            children: \"No Project\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 25\n          }, this), projects.map(project => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: project.id,\n            selected: currentProject ? project.name === currentProject.name : false,\n            children: project.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 33\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"date_picker_part\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"due_date\",\n          children: \"Due date\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          tabIndex: -1,\n          onFocus: () => setShowDatePicker(true),\n          className: setDueDateLabelColor(),\n          children: [/*#__PURE__*/_jsxDEV(DateIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"date\",\n            children: labelDueDate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }, this), isDueDate ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"remove_icon_holder\",\n          onClick: () => removeDueDateHandler(),\n          children: /*#__PURE__*/_jsxDEV(RemoveIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 29\n        }, this) : null, showDatePicker ? /*#__PURE__*/_jsxDEV(DatePicker, {\n          selectedDate: dueDate,\n          setDueDate: setDueDate,\n          setIsDueDate: setIsDueDate,\n          setShowDatePicker: setShowDatePicker\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 29\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: description,\n        onChange: e => setDescription(e.target.value),\n        className: \"description_box\",\n        placeholder: \"Description\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"submit_part\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => submitTaskHandler(),\n          disabled: !taskName || !taskName.trim(),\n          className: \"submit_task\",\n          children: [type, \" Task\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: closeModal,\n      className: \"overlay\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 117,\n    columnNumber: 9\n  }, this);\n};\n\n_s(TaskModal, \"QWNCO8SW1gUKge2iD3mfcyb1p6U=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = TaskModal;\nexport default TaskModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"TaskModal\");","map":{"version":3,"sources":["/Applications/MyFiles/Web/ProjectPlanning/PPA_UI/src/components/User/TaskModal.jsx"],"names":["React","useEffect","useRef","useState","useDispatch","useSelector","createTaskRequest","updateTaskRequest","DateIcon","RemoveIcon","DatePicker","briefMonths","NODUEDATE","TODAY","TOMORROW","YESTERDAY","CREATE","UPDATE","getProjectsRequest","TO_DO","TaskModal","task","closeModal","type","category","currentProject","projects","store","project","find","proj","id","Number","project_Id","taskName","setTaskName","name","description","setDescription","projectId","setProjectId","showDatePicker","setShowDatePicker","dueDate","setDueDate","due_Date","Date","isDueDate","setIsDueDate","labelDueDate","setLabelDueDate","taskNameInput","dispatch","current","focus","getUserId","currentDate","diff","Math","ceil","taskDay","getDate","taskMonth","getMonth","setDueDateLabelColor","className","submitTaskHandler","createTask","updateTask","updatedTask","user_Id","trim","then","data","catch","e","console","log","newTask","assign_Date","sessionStorage","getItem","removeDueDateHandler","target","value","map"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { createTaskRequest, updateTaskRequest } from \"../../services/taskServices\";\nimport { DateIcon, RemoveIcon } from \"../Common/Icons\";\nimport DatePicker from \"./DatePicker\";\nimport { briefMonths, NODUEDATE, TODAY, TOMORROW, YESTERDAY } from \"../../constants/dateConstants\";\nimport { CREATE, UPDATE } from \"../../constants/modalConstants\";\nimport { getProjectsRequest } from \"../../services/projectServices\";\nimport \"../../styles/TaskModal.css\";\nimport { TO_DO } from \"../../constants/taskConstants\";\n\nconst TaskModal = ({ task, closeModal, type, category, currentProject }) => {\n    const projects = useSelector(store => store.projects);\n    const project = projects.find(proj => proj.id === Number(task.project_Id));\n    const [taskName, setTaskName] = useState(task && task.name || \"\");\n    const [description, setDescription] = useState(task && task.description || \"\");\n    const [projectId, setProjectId] = useState(currentProject && currentProject.id || project && project.id || null);\n    const [showDatePicker, setShowDatePicker] = useState(false);\n    const [dueDate, setDueDate] = useState(task && task.due_Date && new Date(task.due_Date) || null);\n    const [isDueDate, setIsDueDate] = useState(!!(task && task.due_Date));\n    const [labelDueDate, setLabelDueDate] = useState(NODUEDATE);\n    const taskNameInput = useRef();\n    const dispatch = useDispatch();\n\n    useEffect(() => type === CREATE ? taskNameInput.current.focus() : null, []);\n    \n    useEffect(async () => await getProjectsRequest(getUserId(), dispatch), []);\n\n    useEffect(() => {\n        if (!isDueDate) {\n            return setLabelDueDate(NODUEDATE);\n        }\n\n        const currentDate = new Date();\n        const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n\n        const taskDay = dueDate.getDate();\n        const taskMonth = dueDate.getMonth();\n\n        switch (diff) {\n            case -1: return setLabelDueDate(YESTERDAY);\n            case 0: return setLabelDueDate(TODAY);\n            case 1: return setLabelDueDate(TOMORROW);\n            default: return setLabelDueDate(taskDay + \" \" + briefMonths[taskMonth]);\n        }\n    }, [dueDate]);\n\n    const setDueDateLabelColor = () => {\n        const className = \"date_picker_holder \";\n\n        if (isDueDate) {\n            const currentDate = new Date();\n            const diff = Math.ceil((dueDate - currentDate) / (1000 * 3600 * 24));\n            \n            if (diff < 0) {\n                return className + \"past_due_date\";\n            }\n            else if (diff === 0 || diff === 1) {\n                return className + \"current_due_date\";\n            }\n            \n            return className + \"future_due_date\";\n        }\n\n        return className;\n    }\n\n    const submitTaskHandler = () => {\n        if (type === CREATE) createTask();\n        if (type === UPDATE) updateTask();\n\n        closeModal();\n    }\n\n    const updateTask = async () => {\n        const updatedTask = {\n            id: task.id,\n            user_Id: getUserId(),\n            project_Id: projectId,\n            category: category || TO_DO,\n            name: taskName.trim(),\n            description: description,\n            due_Date: dueDate\n        }\n\n        return await updateTaskRequest(updatedTask, dispatch)\n            .then(data => data)\n            .catch(e => console.log(e));\n    }\n\n    const createTask = async () => {\n        const newTask = {\n            user_Id: getUserId(),\n            project_Id: projectId != 0 ? projectId : null,\n            category: category || TO_DO,\n            name: taskName.trim(),\n            description: description,\n            assign_Date: new Date(),\n            due_Date: dueDate\n        }\n\n        console.log(newTask);\n\n        return await createTaskRequest(newTask, dispatch)\n            .then(data => data)\n            .catch(e => console.log(e));\n    }\n\n    const getUserId = () => sessionStorage.getItem(\"id\");\n\n    const removeDueDateHandler = () => {\n        setDueDate(null);\n        setIsDueDate(false);\n    }\n\n    return(\n        <div className=\"task_modal\">\n            <div className=\"modal_window\">\n                <input value={taskName} \n                       onChange={e => setTaskName(e.target.value)} \n                       className=\"task_name\" \n                       placeholder=\"Task Name\"\n                       ref={taskNameInput}\n                />\n                <div className=\"who_where\">\n                    <span>For</span>\n                    <select className=\"assign\">\n                        <option>black2001ray@mail.ru</option>\n                        <option>sagidullin-7900@mail.ru</option>\n                    </select>\n                    <span>in</span>\n                    <select onChange={e => setProjectId(e.target.value)} className=\"choose_project\">\n                        <option value={ 0 }>No Project</option>\n                        { \n                            projects.map(project => \n                                <option value={ project.id } \n                                        selected={ currentProject ? project.name === currentProject.name : false }\n                                >{ project.name }</option>) \n                        }\n                    </select>\n                </div>\n                <div className=\"date_picker_part\">\n                    <span className=\"due_date\">Due date</span>\n                    <div tabIndex={-1} onFocus={() => setShowDatePicker(true)} className={setDueDateLabelColor()}> \n                        <DateIcon/>\n                        <span className=\"date\">{ labelDueDate }</span>\n                    </div>\n                    { \n                        isDueDate ? \n                            <div className=\"remove_icon_holder\" onClick={() => removeDueDateHandler()}> \n                                <RemoveIcon/> \n                            </div> : null \n                    }\n                    { \n                        showDatePicker ? \n                            <DatePicker selectedDate={dueDate} \n                                        setDueDate={setDueDate} \n                                        setIsDueDate={setIsDueDate} \n                                        setShowDatePicker={setShowDatePicker} \n                            /> : null \n                    }\n                </div>\n                <textarea value={description} \n                          onChange={e => setDescription(e.target.value)} \n                          className=\"description_box\" \n                          placeholder=\"Description\"\n                />\n                <div className=\"submit_part\">\n                    <button onClick={() => submitTaskHandler()} disabled={!taskName || !taskName.trim()} className=\"submit_task\">\n                        { type } Task \n                    </button>\n                </div>\n            </div>\n            <div onClick={closeModal} className=\"overlay\"></div>\n        </div>\n    )\n}\n\nexport default TaskModal;"]},"metadata":{},"sourceType":"module"}